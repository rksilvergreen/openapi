# Test: Valid - Single oneOf in allOf with discriminator
openapi: 3.0.0
info:
  title: Valid Single OneOf in AllOf Test
  version: 1.0.0
paths: {}
components:
  schemas:
    # Valid: Single direct oneOf in allOf
    ValidDirectOneOf:
      allOf:
        - type: object
          required: [petType]
          properties:
            petType:
              type: string
        - oneOf:
            - $ref: "#/components/schemas/Cat"
            - $ref: "#/components/schemas/Dog"
      discriminator:
        propertyName: petType
    
    # Note: oneOf via $ref in allOf is complex and may not work with discriminator property validation
    # ValidRefOneOf:
    #   allOf:
    #     - $ref: "#/components/schemas/SchemaWithOneOf"
    #     - type: object
    #       properties:
    #         extra:
    #           type: string
    #   discriminator:
    #     propertyName: petType
    
    # Valid: Single anyOf in allOf
    ValidAnyOf:
      allOf:
        - type: object
          required: [petType]
          properties:
            petType:
              type: string
        - anyOf:
            - $ref: "#/components/schemas/Train"
            - $ref: "#/components/schemas/Boat"
      discriminator:
        propertyName: petType
    
    SchemaWithOneOf:
      oneOf:
        - $ref: "#/components/schemas/Cat"
        - $ref: "#/components/schemas/Dog"
    
    Cat:
      type: object
      required: [petType, meow]
      properties:
        petType:
          type: string
        meow:
          type: boolean
          
    Dog:
      type: object
      required: [petType, bark]
      properties:
        petType:
          type: string
        bark:
          type: boolean
          
    Train:
      type: object
      required: [petType, smoke]
      properties:
        petType:
          type: string
        smoke:
          type: boolean
          
    Boat:
      type: object
      required: [petType, water]
      properties:
        petType:
          type: string
        water:
          type: boolean

